//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "MainUnit.h"
//Bound MainForm to DataModule1
#include "DataModule.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TMainForm *MainForm;
//---------------------------------------------------------------------------
__fastcall TMainForm::TMainForm(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------
/*                           Form's Events                                 */
//---------------------------------------------------------------------------
void __fastcall TMainForm::FormClose(TObject *Sender, TCloseAction &Action)
{
        //Deactivate all data bases
        DataModule1->NewbornsTable->Active = false;
        DataModule1->DeadsTable->Active = false;
}
//---------------------------------------------------------------------------

void __fastcall TMainForm::FormCreate(TObject *Sender)
{
        //Hide all panels
        GroupBox->Hide();
        //Active data bases
        DataModule1->NewbornsTable->Active = true;
        DataModule1->NewbornsTable->Open();
        DataModule1->DeadsTable->Active = true;
        DataModule1->DeadsTable->Open();
        //Focused on first page
        PageControl1->ActivePage = NewbornsSheet;

        DBText1->DataSource = DataModule1->NewbornsDS;
        DBText1->DataField = "FIO";
        DBText2->DataSource = DataModule1->NewbornsDS;
        DBText2->DataField = "Sex";
        DBText3->DataSource = DataModule1->NewbornsDS;
        DBText3->DataField = "DateOfBirth";
        DBText4->DataSource = DataModule1->NewbornsDS;
        DBText4->DataField = "PlaceOfBirth";
        Label10->Hide();
        DBText5->Hide();
        Label11->Hide();
        DBText6->Hide();
        Label12->Hide();
        DBText7->Hide();
        Label13->Top = 112;
        DBText8->Top = 128;
        Label13->Show();
        DBText8->Show();
}
//---------------------------------------------------------------------------
/*                              Buttons                                    */
//---------------------------------------------------------------------------
void __fastcall TMainForm::AddButtonClick(TObject *Sender)
{
        GroupBox->Caption = "Добавить запись";
        InformationPanel->Hide();
        GroupBox->Show();
        GroupBox->Top = 24;
        GroupBox->Left = 520;
        if (PageControl1->ActivePage == NewbornsSheet)
        {
                DBEdit1->DataSource = DataModule1->NewbornsDS;
                DBEdit1->DataField = "FIO";
                DBEdit2->DataSource = DataModule1->NewbornsDS;
                DBEdit2->DataField = "Sex";
                DBEdit3->DataSource = DataModule1->NewbornsDS;
                DBEdit3->DataField = "DateOfBirth";
                DBEdit4->DataSource = DataModule1->NewbornsDS;
                DBEdit4->DataField = "PlaceOfBirth";
                Label14->Hide();
                DBEdit5->Hide();
                Label15->Hide();
                DBEdit6->Hide();
                Label16->Hide();
                DBEdit7->Hide();
                Label5->Top = 152;
                DBMemo1->Top = 164;
                Label5->Show();
                DBMemo1->Show();
        }

        if (PageControl1->ActivePage == DeadsSheet)
        {
                DBEdit1->DataSource = DataModule1->DeadsDS;
                DBEdit1->DataField = "FIO";
                DBEdit2->DataSource = DataModule1->DeadsDS;
                DBEdit2->DataField = "Sex";
                DBEdit3->DataSource = DataModule1->DeadsDS;
                DBEdit3->DataField = "DateOfBirth";
                DBEdit4->DataSource = DataModule1->DeadsDS;
                DBEdit4->DataField = "PlaceOfBirth";
                Label5->Hide();
                DBMemo1->Hide();
                Label14->Show();
                DBEdit5->Show();
                Label15->Show();
                DBEdit6->Show();
                Label16->Show();
                DBEdit7->Show();
        }
}
//---------------------------------------------------------------------------

void __fastcall TMainForm::ConfirmButtonClick(TObject *Sender)
{
        if (PageControl1->ActivePage == NewbornsSheet)
        {
                       
        }
}
//---------------------------------------------------------------------------
/*                         PageControl's Events                            */
//---------------------------------------------------------------------------
void __fastcall TMainForm::PageControl1Change(TObject *Sender)
{
        if (PageControl1->ActivePage == NewbornsSheet)
        {
                DBText1->DataSource = DataModule1->NewbornsDS;
                DBText1->DataField = "FIO";
                DBText2->DataSource = DataModule1->NewbornsDS;
                DBText2->DataField = "Sex";
                DBText3->DataSource = DataModule1->NewbornsDS;
                DBText3->DataField = "DateOfBirth";
                DBText4->DataSource = DataModule1->NewbornsDS;
                DBText4->DataField = "PlaceOfBirth";
                Label10->Hide();
                DBText5->Hide();
                Label11->Hide();
                DBText6->Hide();
                Label12->Hide();
                DBText7->Hide();
                Label13->Top = 112;
                DBText8->Top = 128;
                Label13->Show();
                DBText8->Show();
        }

        if (PageControl1->ActivePage == DeadsSheet)
        {
                DBText1->DataSource = DataModule1->DeadsDS;
                DBText1->DataField = "FIO";
                DBText2->DataSource = DataModule1->DeadsDS;
                DBText2->DataField = "Sex";
                DBText3->DataSource = DataModule1->DeadsDS;
                DBText3->DataField = "DateOfBirth";
                DBText4->DataSource = DataModule1->DeadsDS;
                DBText4->DataField = "PlaceOfBirth";
                Label10->Show();
                DBText5->Show();
                Label11->Show();
                DBText6->Show();
                Label12->Show();
                DBText7->Show();
                Label13->Hide();
                DBText8->Hide();
        }
}
//---------------------------------------------------------------------------
